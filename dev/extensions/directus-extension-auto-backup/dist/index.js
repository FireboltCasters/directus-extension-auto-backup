import e from"fs";import t from"path";var n,a;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),a={};for(const e of n)a[e]=t[e];return e.objectValues(a)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(n||(n={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(a||(a={}));const i=n.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),r=e=>{switch(typeof e){case"undefined":return i.undefined;case"string":return i.string;case"number":return isNaN(e)?i.nan:i.number;case"boolean":return i.boolean;case"function":return i.function;case"bigint":return i.bigint;case"symbol":return i.symbol;case"object":return Array.isArray(e)?i.array:null===e?i.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?i.promise:"undefined"!=typeof Map&&e instanceof Map?i.map:"undefined"!=typeof Set&&e instanceof Set?i.set:"undefined"!=typeof Date&&e instanceof Date?i.date:i.object;default:return i.unknown}},s=n.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class o extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},a=e=>{for(const i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(a);else if("invalid_return_type"===i.code)a(i.returnTypeError);else if("invalid_arguments"===i.code)a(i.argumentsError);else if(0===i.path.length)n._errors.push(t(i));else{let e=n,a=0;for(;a<i.path.length;){const n=i.path[a];a===i.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(i))):e[n]=e[n]||{_errors:[]},e=e[n],a++}}};return a(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},n=[];for(const a of this.issues)a.path.length>0?(t[a.path[0]]=t[a.path[0]]||[],t[a.path[0]].push(e(a))):n.push(e(a));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}o.create=e=>new o(e);const l=(e,t)=>{let a;switch(e.code){case s.invalid_type:a=e.received===i.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case s.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(e.expected,n.jsonStringifyReplacer)}`;break;case s.unrecognized_keys:a=`Unrecognized key(s) in object: ${n.joinValues(e.keys,", ")}`;break;case s.invalid_union:a="Invalid input";break;case s.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${n.joinValues(e.options)}`;break;case s.invalid_enum_value:a=`Invalid enum value. Expected ${n.joinValues(e.options)}, received '${e.received}'`;break;case s.invalid_arguments:a="Invalid function arguments";break;case s.invalid_return_type:a="Invalid function return type";break;case s.invalid_date:a="Invalid date";break;case s.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(a=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(a=`${a} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?a=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?a=`Invalid input: must end with "${e.validation.endsWith}"`:n.assertNever(e.validation):a="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case s.too_small:a="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case s.too_big:a="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case s.custom:a="Invalid input";break;case s.invalid_intersection_types:a="Intersection results could not be merged";break;case s.not_multiple_of:a=`Number must be a multiple of ${e.multipleOf}`;break;case s.not_finite:a="Number must be finite";break;default:a=t.defaultError,n.assertNever(e)}return{message:a}};let u=l;function c(){return u}const d=e=>{const{data:t,path:n,errorMaps:a,issueData:i}=e,r=[...n,...i.path||[]],s={...i,path:r};let o="";const l=a.filter((e=>!!e)).slice().reverse();for(const e of l)o=e(s,{data:t,defaultError:o}).message;return{...i,path:r,message:i.message||o}};function p(e,t){const n=d({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,c(),l].filter((e=>!!e))});e.common.issues.push(n)}class h{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const a of t){if("aborted"===a.status)return f;"dirty"===a.status&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t)n.push({key:await e.key,value:await e.value});return h.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const a of t){const{key:t,value:i}=a;if("aborted"===t.status)return f;if("aborted"===i.status)return f;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"===t.value||void 0===i.value&&!a.alwaysSet||(n[t.value]=i.value)}return{status:e.value,value:n}}}const f=Object.freeze({status:"aborted"}),m=e=>({status:"dirty",value:e}),g=e=>({status:"valid",value:e}),_=e=>"aborted"===e.status,y=e=>"dirty"===e.status,v=e=>"valid"===e.status,b=e=>"undefined"!=typeof Promise&&e instanceof Promise;var k;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(k||(k={}));class w{constructor(e,t,n,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const x=(e,t)=>{if(v(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new o(e.common.issues);return this._error=t,this._error}}};function S(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:a,description:i}=e;if(t&&(n||a))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:i};return{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=a?a:t.defaultError}:{message:null!=n?n:t.defaultError},description:i}}class T{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return r(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:r(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new h,ctx:{common:e.parent.common,data:e.data,parsedType:r(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(b(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const a={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:r(e)},i=this._parseSync({data:e,path:a.path,parent:a});return x(a,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:r(e)},a=this._parse({data:e,path:n.path,parent:n}),i=await(b(a)?a:Promise.resolve(a));return x(n,i)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,a)=>{const i=e(t),r=()=>a.addIssue({code:s.custom,...n(t)});return"undefined"!=typeof Promise&&i instanceof Promise?i.then((e=>!!e||(r(),!1))):!!i||(r(),!1)}))}refinement(e,t){return this._refinement(((n,a)=>!!e(n)||(a.addIssue("function"==typeof t?t(n,a):t),!1)))}_refinement(e){return new pe({schema:this,typeName:Se.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return he.create(this,this._def)}nullable(){return fe.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return V.create(this,this._def)}promise(){return de.create(this,this._def)}or(e){return G.create([this,e],this._def)}and(e){return ee.create(this,e,this._def)}transform(e){return new pe({...S(this._def),schema:this,typeName:Se.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new me({...S(this._def),innerType:this,defaultValue:t,typeName:Se.ZodDefault})}brand(){return new ve({typeName:Se.ZodBranded,type:this,...S(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ge({...S(this._def),innerType:this,catchValue:t,typeName:Se.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return be.create(this,e)}readonly(){return ke.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const A=/^c[^\s-]{8,}$/i,C=/^[a-z][a-z0-9]*$/,N=/^[0-9A-HJKMNP-TV-Z]{26}$/,O=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let E;const I=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,j=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class M extends T{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==i.string){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.string,received:t.parsedType}),f}const t=new h;let a;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),p(a,{code:s.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),p(a,{code:s.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const n=e.data.length>i.value,r=e.data.length<i.value;(n||r)&&(a=this._getOrReturnCtx(e,a),n?p(a,{code:s.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):r&&p(a,{code:s.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)L.test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{validation:"email",code:s.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)E||(E=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),E.test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{validation:"emoji",code:s.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)O.test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{validation:"uuid",code:s.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)A.test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{validation:"cuid",code:s.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)C.test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{validation:"cuid2",code:s.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)N.test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{validation:"ulid",code:s.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(n){a=this._getOrReturnCtx(e,a),p(a,{validation:"url",code:s.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{validation:"regex",code:s.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),p(a,{code:s.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),p(a,{code:s.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),p(a,{code:s.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){((l=i).precision?l.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}Z$`):0===l.precision?l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(a=this._getOrReturnCtx(e,a),p(a,{code:s.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else"ip"===i.kind?(r=e.data,("v4"!==(o=i.version)&&o||!I.test(r))&&("v6"!==o&&o||!j.test(r))&&(a=this._getOrReturnCtx(e,a),p(a,{validation:"ip",code:s.invalid_string,message:i.message}),t.dirty())):n.assertNever(i);var r,o,l;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:s.invalid_string,...k.errToObj(n)})}_addCheck(e){return new M({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...k.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...k.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...k.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...k.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...k.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...k.errToObj(t)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new M({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new M({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new M({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function F(e,t){const n=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,i=n>a?n:a;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}M.create=e=>{var t;return new M({checks:[],typeName:Se.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...S(e)})};class Z extends T{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==i.number){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.number,received:t.parsedType}),f}let t;const a=new h;for(const i of this._def.checks)if("int"===i.kind)n.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),p(t,{code:s.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty());else if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:s.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:s.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty())}else"multipleOf"===i.kind?0!==F(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:s.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),p(t,{code:s.not_finite,message:i.message}),a.dirty()):n.assertNever(i);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,a){return new Z({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(a)}]})}_addCheck(e){return new Z({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&n.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Z.create=e=>new Z({checks:[],typeName:Se.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...S(e)});class D extends T{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==i.bigint){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.bigint,received:t.parsedType}),f}let t;const a=new h;for(const i of this._def.checks)if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:s.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),p(t,{code:s.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty())}else"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),p(t,{code:s.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):n.assertNever(i);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,a){return new D({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(a)}]})}_addCheck(e){return new D({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}D.create=e=>{var t;return new D({checks:[],typeName:Se.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...S(e)})};class P extends T{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==i.boolean){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.boolean,received:t.parsedType}),f}return g(e.data)}}P.create=e=>new P({typeName:Se.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...S(e)});class q extends T{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==i.date){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.date,received:t.parsedType}),f}if(isNaN(e.data.getTime())){return p(this._getOrReturnCtx(e),{code:s.invalid_date}),f}const t=new h;let a;for(const i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),p(a,{code:s.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),t.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),p(a,{code:s.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),t.dirty()):n.assertNever(i);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new q({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}q.create=e=>new q({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Se.ZodDate,...S(e)});class B extends T{_parse(e){if(this._getType(e)!==i.symbol){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.symbol,received:t.parsedType}),f}return g(e.data)}}B.create=e=>new B({typeName:Se.ZodSymbol,...S(e)});class R extends T{_parse(e){if(this._getType(e)!==i.undefined){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.undefined,received:t.parsedType}),f}return g(e.data)}}R.create=e=>new R({typeName:Se.ZodUndefined,...S(e)});class U extends T{_parse(e){if(this._getType(e)!==i.null){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.null,received:t.parsedType}),f}return g(e.data)}}U.create=e=>new U({typeName:Se.ZodNull,...S(e)});class W extends T{constructor(){super(...arguments),this._any=!0}_parse(e){return g(e.data)}}W.create=e=>new W({typeName:Se.ZodAny,...S(e)});class $ extends T{constructor(){super(...arguments),this._unknown=!0}_parse(e){return g(e.data)}}$.create=e=>new $({typeName:Se.ZodUnknown,...S(e)});class Y extends T{_parse(e){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.never,received:t.parsedType}),f}}Y.create=e=>new Y({typeName:Se.ZodNever,...S(e)});class z extends T{_parse(e){if(this._getType(e)!==i.undefined){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.void,received:t.parsedType}),f}return g(e.data)}}z.create=e=>new z({typeName:Se.ZodVoid,...S(e)});class V extends T{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),a=this._def;if(t.parsedType!==i.array)return p(t,{code:s.invalid_type,expected:i.array,received:t.parsedType}),f;if(null!==a.exactLength){const e=t.data.length>a.exactLength.value,i=t.data.length<a.exactLength.value;(e||i)&&(p(t,{code:e?s.too_big:s.too_small,minimum:i?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&(p(t,{code:s.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&(p(t,{code:s.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>a.type._parseAsync(new w(t,e,t.path,n))))).then((e=>h.mergeArray(n,e)));const r=[...t.data].map(((e,n)=>a.type._parseSync(new w(t,e,t.path,n))));return h.mergeArray(n,r)}get element(){return this._def.type}min(e,t){return new V({...this._def,minLength:{value:e,message:k.toString(t)}})}max(e,t){return new V({...this._def,maxLength:{value:e,message:k.toString(t)}})}length(e,t){return new V({...this._def,exactLength:{value:e,message:k.toString(t)}})}nonempty(e){return this.min(1,e)}}function H(e){if(e instanceof K){const t={};for(const n in e.shape){const a=e.shape[n];t[n]=he.create(H(a))}return new K({...e._def,shape:()=>t})}return e instanceof V?new V({...e._def,type:H(e.element)}):e instanceof he?he.create(H(e.unwrap())):e instanceof fe?fe.create(H(e.unwrap())):e instanceof te?te.create(e.items.map((e=>H(e)))):e}V.create=(e,t)=>new V({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Se.ZodArray,...S(t)});class K extends T{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=n.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==i.object){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.object,received:t.parsedType}),f}const{status:t,ctx:n}=this._processInputParams(e),{shape:a,keys:r}=this._getCached(),o=[];if(!(this._def.catchall instanceof Y&&"strip"===this._def.unknownKeys))for(const e in n.data)r.includes(e)||o.push(e);const l=[];for(const e of r){const t=a[e],i=n.data[e];l.push({key:{status:"valid",value:e},value:t._parse(new w(n,i,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof Y){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of o)l.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)o.length>0&&(p(n,{code:s.unrecognized_keys,keys:o}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of o){const a=n.data[t];l.push({key:{status:"valid",value:t},value:e._parse(new w(n,a,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of l){const n=await t.key;e.push({key:n,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>h.mergeObjectSync(t,e))):h.mergeObjectSync(t,l)}get shape(){return this._def.shape()}strict(e){return k.errToObj,new K({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var a,i,r,s;const o=null!==(r=null===(i=(a=this._def).errorMap)||void 0===i?void 0:i.call(a,t,n).message)&&void 0!==r?r:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=k.errToObj(e).message)&&void 0!==s?s:o}:{message:o}}}:{}})}strip(){return new K({...this._def,unknownKeys:"strip"})}passthrough(){return new K({...this._def,unknownKeys:"passthrough"})}extend(e){return new K({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new K({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Se.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new K({...this._def,catchall:e})}pick(e){const t={};return n.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new K({...this._def,shape:()=>t})}omit(e){const t={};return n.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new K({...this._def,shape:()=>t})}deepPartial(){return H(this)}partial(e){const t={};return n.objectKeys(this.shape).forEach((n=>{const a=this.shape[n];e&&!e[n]?t[n]=a:t[n]=a.optional()})),new K({...this._def,shape:()=>t})}required(e){const t={};return n.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof he;)e=e._def.innerType;t[n]=e}})),new K({...this._def,shape:()=>t})}keyof(){return le(n.objectKeys(this.shape))}}K.create=(e,t)=>new K({shape:()=>e,unknownKeys:"strip",catchall:Y.create(),typeName:Se.ZodObject,...S(t)}),K.strictCreate=(e,t)=>new K({shape:()=>e,unknownKeys:"strict",catchall:Y.create(),typeName:Se.ZodObject,...S(t)}),K.lazycreate=(e,t)=>new K({shape:e,unknownKeys:"strip",catchall:Y.create(),typeName:Se.ZodObject,...S(t)});class G extends T{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new o(e.ctx.common.issues)));return p(t,{code:s.invalid_union,unionErrors:n}),f}));{let e;const a=[];for(const i of n){const n={...t,common:{...t.common,issues:[]},parent:null},r=i._parseSync({data:t.data,path:t.path,parent:n});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:n}),n.common.issues.length&&a.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const i=a.map((e=>new o(e)));return p(t,{code:s.invalid_union,unionErrors:i}),f}}get options(){return this._def.options}}G.create=(e,t)=>new G({options:e,typeName:Se.ZodUnion,...S(t)});const Q=e=>e instanceof se?Q(e.schema):e instanceof pe?Q(e.innerType()):e instanceof oe?[e.value]:e instanceof ue?e.options:e instanceof ce?Object.keys(e.enum):e instanceof me?Q(e._def.innerType):e instanceof R?[void 0]:e instanceof U?[null]:null;class X extends T{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.object)return p(t,{code:s.invalid_type,expected:i.object,received:t.parsedType}),f;const n=this.discriminator,a=t.data[n],r=this.optionsMap.get(a);return r?t.common.async?r._parseAsync({data:t.data,path:t.path,parent:t}):r._parseSync({data:t.data,path:t.path,parent:t}):(p(t,{code:s.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),f)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const a=new Map;for(const n of t){const t=Q(n.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const i of t){if(a.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);a.set(i,n)}}return new X({typeName:Se.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...S(n)})}}function J(e,t){const a=r(e),s=r(t);if(e===t)return{valid:!0,data:e};if(a===i.object&&s===i.object){const a=n.objectKeys(t),i=n.objectKeys(e).filter((e=>-1!==a.indexOf(e))),r={...e,...t};for(const n of i){const a=J(e[n],t[n]);if(!a.valid)return{valid:!1};r[n]=a.data}return{valid:!0,data:r}}if(a===i.array&&s===i.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let a=0;a<e.length;a++){const i=J(e[a],t[a]);if(!i.valid)return{valid:!1};n.push(i.data)}return{valid:!0,data:n}}return a===i.date&&s===i.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ee extends T{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=(e,a)=>{if(_(e)||_(a))return f;const i=J(e.value,a.value);return i.valid?((y(e)||y(a))&&t.dirty(),{status:t.value,value:i.data}):(p(n,{code:s.invalid_intersection_types}),f)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>a(e,t))):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ee.create=(e,t,n)=>new ee({left:e,right:t,typeName:Se.ZodIntersection,...S(n)});class te extends T{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.array)return p(n,{code:s.invalid_type,expected:i.array,received:n.parsedType}),f;if(n.data.length<this._def.items.length)return p(n,{code:s.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),f;!this._def.rest&&n.data.length>this._def.items.length&&(p(n,{code:s.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...n.data].map(((e,t)=>{const a=this._def.items[t]||this._def.rest;return a?a._parse(new w(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(a).then((e=>h.mergeArray(t,e))):h.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new te({...this._def,rest:e})}}te.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new te({items:e,typeName:Se.ZodTuple,rest:null,...S(t)})};class ne extends T{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.object)return p(n,{code:s.invalid_type,expected:i.object,received:n.parsedType}),f;const a=[],r=this._def.keyType,o=this._def.valueType;for(const e in n.data)a.push({key:r._parse(new w(n,e,n.path,e)),value:o._parse(new w(n,n.data[e],n.path,e))});return n.common.async?h.mergeObjectAsync(t,a):h.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,n){return new ne(t instanceof T?{keyType:e,valueType:t,typeName:Se.ZodRecord,...S(n)}:{keyType:M.create(),valueType:e,typeName:Se.ZodRecord,...S(t)})}}class ae extends T{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.map)return p(n,{code:s.invalid_type,expected:i.map,received:n.parsedType}),f;const a=this._def.keyType,r=this._def.valueType,o=[...n.data.entries()].map((([e,t],i)=>({key:a._parse(new w(n,e,n.path,[i,"key"])),value:r._parse(new w(n,t,n.path,[i,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of o){const a=await n.key,i=await n.value;if("aborted"===a.status||"aborted"===i.status)return f;"dirty"!==a.status&&"dirty"!==i.status||t.dirty(),e.set(a.value,i.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of o){const a=n.key,i=n.value;if("aborted"===a.status||"aborted"===i.status)return f;"dirty"!==a.status&&"dirty"!==i.status||t.dirty(),e.set(a.value,i.value)}return{status:t.value,value:e}}}}ae.create=(e,t,n)=>new ae({valueType:t,keyType:e,typeName:Se.ZodMap,...S(n)});class ie extends T{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==i.set)return p(n,{code:s.invalid_type,expected:i.set,received:n.parsedType}),f;const a=this._def;null!==a.minSize&&n.data.size<a.minSize.value&&(p(n,{code:s.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&n.data.size>a.maxSize.value&&(p(n,{code:s.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const r=this._def.valueType;function o(e){const n=new Set;for(const a of e){if("aborted"===a.status)return f;"dirty"===a.status&&t.dirty(),n.add(a.value)}return{status:t.value,value:n}}const l=[...n.data.values()].map(((e,t)=>r._parse(new w(n,e,n.path,t))));return n.common.async?Promise.all(l).then((e=>o(e))):o(l)}min(e,t){return new ie({...this._def,minSize:{value:e,message:k.toString(t)}})}max(e,t){return new ie({...this._def,maxSize:{value:e,message:k.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ie.create=(e,t)=>new ie({valueType:e,minSize:null,maxSize:null,typeName:Se.ZodSet,...S(t)});class re extends T{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.function)return p(t,{code:s.invalid_type,expected:i.function,received:t.parsedType}),f;function n(e,n){return d({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,c(),l].filter((e=>!!e)),issueData:{code:s.invalid_arguments,argumentsError:n}})}function a(e,n){return d({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,c(),l].filter((e=>!!e)),issueData:{code:s.invalid_return_type,returnTypeError:n}})}const r={errorMap:t.common.contextualErrorMap},u=t.data;if(this._def.returns instanceof de){const e=this;return g((async function(...t){const i=new o([]),s=await e._def.args.parseAsync(t,r).catch((e=>{throw i.addIssue(n(t,e)),i})),l=await Reflect.apply(u,this,s);return await e._def.returns._def.type.parseAsync(l,r).catch((e=>{throw i.addIssue(a(l,e)),i}))}))}{const e=this;return g((function(...t){const i=e._def.args.safeParse(t,r);if(!i.success)throw new o([n(t,i.error)]);const s=Reflect.apply(u,this,i.data),l=e._def.returns.safeParse(s,r);if(!l.success)throw new o([a(s,l.error)]);return l.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new re({...this._def,args:te.create(e).rest($.create())})}returns(e){return new re({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new re({args:e||te.create([]).rest($.create()),returns:t||$.create(),typeName:Se.ZodFunction,...S(n)})}}class se extends T{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}se.create=(e,t)=>new se({getter:e,typeName:Se.ZodLazy,...S(t)});class oe extends T{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return p(t,{received:t.data,code:s.invalid_literal,expected:this._def.value}),f}return{status:"valid",value:e.data}}get value(){return this._def.value}}function le(e,t){return new ue({values:e,typeName:Se.ZodEnum,...S(t)})}oe.create=(e,t)=>new oe({value:e,typeName:Se.ZodLiteral,...S(t)});class ue extends T{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),a=this._def.values;return p(t,{expected:n.joinValues(a),received:t.parsedType,code:s.invalid_type}),f}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return p(t,{received:t.data,code:s.invalid_enum_value,options:n}),f}return g(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return ue.create(e)}exclude(e){return ue.create(this.options.filter((t=>!e.includes(t))))}}ue.create=le;class ce extends T{_parse(e){const t=n.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(e);if(a.parsedType!==i.string&&a.parsedType!==i.number){const e=n.objectValues(t);return p(a,{expected:n.joinValues(e),received:a.parsedType,code:s.invalid_type}),f}if(-1===t.indexOf(e.data)){const e=n.objectValues(t);return p(a,{received:a.data,code:s.invalid_enum_value,options:e}),f}return g(e.data)}get enum(){return this._def.values}}ce.create=(e,t)=>new ce({values:e,typeName:Se.ZodNativeEnum,...S(t)});class de extends T{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.promise&&!1===t.common.async)return p(t,{code:s.invalid_type,expected:i.promise,received:t.parsedType}),f;const n=t.parsedType===i.promise?t.data:Promise.resolve(t.data);return g(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}de.create=(e,t)=>new de({type:e,typeName:Se.ZodPromise,...S(t)});class pe extends T{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Se.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:a}=this._processInputParams(e),i=this._def.effect||null,r={addIssue:e=>{p(a,e),e.fatal?t.abort():t.dirty()},get path(){return a.path}};if(r.addIssue=r.addIssue.bind(r),"preprocess"===i.type){const e=i.transform(a.data,r);return a.common.issues.length?{status:"dirty",value:a.data}:a.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:a.path,parent:a}))):this._def.schema._parseSync({data:e,path:a.path,parent:a})}if("refinement"===i.type){const e=e=>{const t=i.refinement(e,r);if(a.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===a.common.async){const n=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return"aborted"===n.status?f:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then((n=>"aborted"===n.status?f:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===i.type){if(!1===a.common.async){const e=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!v(e))return e;const n=i.transform(e.value,r);if(n instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:n}}return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then((e=>v(e)?Promise.resolve(i.transform(e.value,r)).then((e=>({status:t.value,value:e}))):e))}n.assertNever(i)}}pe.create=(e,t,n)=>new pe({schema:e,typeName:Se.ZodEffects,effect:t,...S(n)}),pe.createWithPreprocess=(e,t,n)=>new pe({schema:t,effect:{type:"preprocess",transform:e},typeName:Se.ZodEffects,...S(n)});class he extends T{_parse(e){return this._getType(e)===i.undefined?g(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}he.create=(e,t)=>new he({innerType:e,typeName:Se.ZodOptional,...S(t)});class fe extends T{_parse(e){return this._getType(e)===i.null?g(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}fe.create=(e,t)=>new fe({innerType:e,typeName:Se.ZodNullable,...S(t)});class me extends T{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===i.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}me.create=(e,t)=>new me({innerType:e,typeName:Se.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...S(t)});class ge extends T{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return b(a)?a.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new o(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new o(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ge.create=(e,t)=>new ge({innerType:e,typeName:Se.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...S(t)});class _e extends T{_parse(e){if(this._getType(e)!==i.nan){const t=this._getOrReturnCtx(e);return p(t,{code:s.invalid_type,expected:i.nan,received:t.parsedType}),f}return{status:"valid",value:e.data}}}_e.create=e=>new _e({typeName:Se.ZodNaN,...S(e)});const ye=Symbol("zod_brand");class ve extends T{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class be extends T{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?f:"dirty"===e.status?(t.dirty(),m(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?f:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new be({in:e,out:t,typeName:Se.ZodPipeline})}}class ke extends T{_parse(e){const t=this._def.innerType._parse(e);return v(t)&&(t.value=Object.freeze(t.value)),t}}ke.create=(e,t)=>new ke({innerType:e,typeName:Se.ZodReadonly,...S(t)});const we=(e,t={},n)=>e?W.create().superRefine(((a,i)=>{var r,s;if(!e(a)){const e="function"==typeof t?t(a):"string"==typeof t?{message:t}:t,o=null===(s=null!==(r=e.fatal)&&void 0!==r?r:n)||void 0===s||s,l="string"==typeof e?{message:e}:e;i.addIssue({code:"custom",...l,fatal:o})}})):W.create(),xe={object:K.lazycreate};var Se;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Se||(Se={}));const Te=M.create,Ae=Z.create,Ce=_e.create,Ne=D.create,Oe=P.create,Le=q.create,Ee=B.create,Ie=R.create,je=U.create,Me=W.create,Fe=$.create,Ze=Y.create,De=z.create,Pe=V.create,qe=K.create,Be=K.strictCreate,Re=G.create,Ue=X.create,We=ee.create,$e=te.create,Ye=ne.create,ze=ae.create,Ve=ie.create,He=re.create,Ke=se.create,Ge=oe.create,Qe=ue.create,Xe=ce.create,Je=de.create,et=pe.create,tt=he.create,nt=fe.create,at=pe.createWithPreprocess,it=be.create,rt={string:e=>M.create({...e,coerce:!0}),number:e=>Z.create({...e,coerce:!0}),boolean:e=>P.create({...e,coerce:!0}),bigint:e=>D.create({...e,coerce:!0}),date:e=>q.create({...e,coerce:!0})},st=f;var ot=Object.freeze({__proto__:null,defaultErrorMap:l,setErrorMap:function(e){u=e},getErrorMap:c,makeIssue:d,EMPTY_PATH:[],addIssueToContext:p,ParseStatus:h,INVALID:f,DIRTY:m,OK:g,isAborted:_,isDirty:y,isValid:v,isAsync:b,get util(){return n},get objectUtil(){return a},ZodParsedType:i,getParsedType:r,ZodType:T,ZodString:M,ZodNumber:Z,ZodBigInt:D,ZodBoolean:P,ZodDate:q,ZodSymbol:B,ZodUndefined:R,ZodNull:U,ZodAny:W,ZodUnknown:$,ZodNever:Y,ZodVoid:z,ZodArray:V,ZodObject:K,ZodUnion:G,ZodDiscriminatedUnion:X,ZodIntersection:ee,ZodTuple:te,ZodRecord:ne,ZodMap:ae,ZodSet:ie,ZodFunction:re,ZodLazy:se,ZodLiteral:oe,ZodEnum:ue,ZodNativeEnum:ce,ZodPromise:de,ZodEffects:pe,ZodTransformer:pe,ZodOptional:he,ZodNullable:fe,ZodDefault:me,ZodCatch:ge,ZodNaN:_e,BRAND:ye,ZodBranded:ve,ZodPipeline:be,ZodReadonly:ke,custom:we,Schema:T,ZodSchema:T,late:xe,get ZodFirstPartyTypeKind(){return Se},coerce:rt,any:Me,array:Pe,bigint:Ne,boolean:Oe,date:Le,discriminatedUnion:Ue,effect:et,enum:Qe,function:He,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>we((t=>t instanceof e),t),intersection:We,lazy:Ke,literal:Ge,map:ze,nan:Ce,nativeEnum:Xe,never:Ze,null:je,nullable:nt,number:Ae,object:qe,oboolean:()=>Oe().optional(),onumber:()=>Ae().optional(),optional:tt,ostring:()=>Te().optional(),pipeline:it,preprocess:at,promise:Je,record:Ye,set:Ve,strictObject:Be,string:Te,symbol:Ee,transformer:et,tuple:$e,undefined:Ie,union:Re,unknown:Fe,void:De,NEVER:st,ZodIssueCode:s,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:o}),lt=["interface","display","layout","module","panel","theme"],ut=["hook","endpoint"],ct=["operation"],dt=ot.object({app:ot.string(),api:ot.string()}),pt=ot.object({request:ot.optional(ot.object({urls:ot.array(ot.string()),methods:ot.array(ot.union([ot.literal("GET"),ot.literal("POST"),ot.literal("PATCH"),ot.literal("PUT"),ot.literal("DELETE")]))})),log:ot.optional(ot.object({})),sleep:ot.optional(ot.object({}))}),ht=ot.optional(ot.object({enabled:ot.boolean(),requestedScopes:pt})),ft=ot.union([ot.object({type:ot.enum(ut),name:ot.string(),source:ot.string()}),ot.object({type:ot.enum(lt),name:ot.string(),source:ot.string()}),ot.object({type:ot.enum(ct),name:ot.string(),source:dt})]),mt=ot.object({host:ot.string(),hidden:ot.boolean().optional()}),gt=ot.object({type:ot.enum(lt),path:ot.string(),source:ot.string()}),_t=ot.object({type:ot.enum(ut),path:ot.string(),source:ot.string(),sandbox:ht}),yt=ot.object({type:ot.enum(ct),path:dt,source:dt,sandbox:ht}),vt=ot.object({type:ot.literal("bundle"),path:dt,entries:ot.array(ft)});ot.array(ft);var bt=mt.and(ot.union([gt,_t,yt,vt]));ot.object({name:ot.string(),version:ot.string(),type:ot.union([ot.literal("module"),ot.literal("commonjs")]).optional(),description:ot.string().optional(),icon:ot.string().optional(),dependencies:ot.record(ot.string()).optional(),devDependencies:ot.record(ot.string()).optional(),"directus:extension":bt});class kt{constructor(e,t,n){this.services=e,this.database=t,this.schema=n}getCollectionsService(){const{CollectionsService:e}=this.services;return new e({accountability:null,knex:this.database,schema:this.schema})}}class wt{constructor(e,t,n){this.services=e,this.database=t,this.schema=n}getItemsService(e){const{ItemsService:t}=this.services;return new t(e,{accountability:null,knex:this.database,schema:this.schema})}}class xt{static TABLENAME="auto_backup_settings";constructor(e,t,n){this.database=t,this.itemsServiceCreator=new wt(e,t,n)}async init(){this.translationSettingsService=await this.itemsServiceCreator.getItemsService(xt.TABLENAME)}async setSettings(e){let t=await this.getSettings();t&&t?.id&&await this.translationSettingsService.updateOne(t?.id,e)}async getActiveStatus(){let e=await this.getSettings();return e?.active}async getState(){let e=await this.getSettings();return e?.state}async getDBClient(){let e=await this.getSettings();return e?.DB_CLIENT||"sqlite3"}isSQLITE3DBClient(e){return"sqlite3"===e}async getBackupLocationType(){let e=await this.getSettings();return e?.backup_location_type||"file_library"}isBackupLocationTypeFileLibrary(e){return"file_library"===e}async getBackupLocationFileLibraryFolderName(){let e=await this.getSettings();return e?.backup_location_folder_name||"backups"}async setBackupLocationFileLibraryFolderName(e){await this.setSettings({backup_location_folder_name:e})}async getBackupLocationFileLibraryFolderID(){let e=await this.getSettings();return e?.backup_location_folder_id}async getBackupFileFormatPrefix(){let e=await this.getSettings(),t=e?.backup_file_format_prefix;return null==t?"backup-":t||""}async getBackupFileFormatPostfix(){let e=await this.getSettings();return e?.backup_file_format_postfix||""}async getBackupFileFormat(){let e=await this.getSettings(),t=e?.backup_file_format;return null==t?"YYYY-MM-DD-HH-mm-ss-SSS":t||""}async setBackupLocationFileLibraryFolderID(e){await this.setSettings({backup_location_folder_id:e})}isBackupLocationTypeCustomPath(e){return"custom_path"===e}async getBackupLocationCustomPath(){let e=await this.getSettings();return e?.backup_location_custom_path}async getSQLITE3DBFilename(){let e=await this.getSettings(),t=e?.sqlite3_db_filename;return t||"/directus/database/data.db"}async setCurrentState(e){await this.setSettings({state:e})}async setLatestLog(e){await this.setSettings({latest_log:e})}async getSettings(){let e=await this.translationSettingsService.readByQuery({});return e&&e.length>0?e[0]:null}async isAutoBackupEnabled(){let e=await this.getSettings();return e?.active}}
/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */
function St(e){return null==e}var Tt=function(e,t){var n,a,i,r;if(t)for(n=0,a=(r=Object.keys(t)).length;n<a;n+=1)e[i=r[n]]=t[i];return e},At={isNothing:St,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:St(e)?[]:[e]},repeat:function(e,t){var n,a="";for(n=0;n<t;n+=1)a+=e;return a},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:Tt};function Ct(e,t){var n="",a=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),a+" "+n):a}function Nt(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Ct(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}Nt.prototype=Object.create(Error.prototype),Nt.prototype.constructor=Nt,Nt.prototype.toString=function(e){return this.name+": "+Ct(this,e)};var Ot=Nt;function Lt(e,t,n,a,i){var r="",s="",o=Math.floor(i/2)-1;return a-t>o&&(t=a-o+(r=" ... ").length),n-a>o&&(n=a+o-(s=" ...").length),{str:r+e.slice(t,n).replace(/\t/g,"→")+s,pos:a-t+r.length}}function Et(e,t){return At.repeat(" ",t-e.length)+e}var It=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,a=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;n=a.exec(e.buffer);)r.push(n.index),i.push(n.index+n[0].length),e.position<=n.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var o,l,u="",c=Math.min(e.line+t.linesAfter,r.length).toString().length,d=t.maxLength-(t.indent+c+3);for(o=1;o<=t.linesBefore&&!(s-o<0);o++)l=Lt(e.buffer,i[s-o],r[s-o],e.position-(i[s]-i[s-o]),d),u=At.repeat(" ",t.indent)+Et((e.line-o+1).toString(),c)+" | "+l.str+"\n"+u;for(l=Lt(e.buffer,i[s],r[s],e.position,d),u+=At.repeat(" ",t.indent)+Et((e.line+1).toString(),c)+" | "+l.str+"\n",u+=At.repeat("-",t.indent+c+3+l.pos)+"^\n",o=1;o<=t.linesAfter&&!(s+o>=r.length);o++)l=Lt(e.buffer,i[s+o],r[s+o],e.position-(i[s]-i[s+o]),d),u+=At.repeat(" ",t.indent)+Et((e.line+o+1).toString(),c)+" | "+l.str+"\n";return u.replace(/\n$/,"")},jt=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Mt=["scalar","sequence","mapping"];var Ft=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===jt.indexOf(t))throw new Ot('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}(t.styleAliases||null),-1===Mt.indexOf(this.kind))throw new Ot('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function Zt(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,a){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=a)})),n[t]=e})),n}function Dt(e){return this.extend(e)}Dt.prototype.extend=function(e){var t=[],n=[];if(e instanceof Ft)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new Ot("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof Ft))throw new Ot("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new Ot("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new Ot("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof Ft))throw new Ot("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var a=Object.create(Dt.prototype);return a.implicit=(this.implicit||[]).concat(t),a.explicit=(this.explicit||[]).concat(n),a.compiledImplicit=Zt(a,"implicit"),a.compiledExplicit=Zt(a,"explicit"),a.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function a(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(a);return n}(a.compiledImplicit,a.compiledExplicit),a};var Pt=Dt,qt=new Ft("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),Bt=new Ft("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),Rt=new Ft("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),Ut=new Pt({explicit:[qt,Bt,Rt]});var Wt=new Ft("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});var $t=new Ft("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function Yt(e){return 48<=e&&e<=55}function zt(e){return 48<=e&&e<=57}var Vt=new Ft("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,a=e.length,i=0,r=!1;if(!a)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===a)return!0;if("b"===(t=e[++i])){for(i++;i<a;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;r=!0}return r&&"_"!==t}if("x"===t){for(i++;i<a;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;r=!0}return r&&"_"!==t}if("o"===t){for(i++;i<a;i++)if("_"!==(t=e[i])){if(!Yt(e.charCodeAt(i)))return!1;r=!0}return r&&"_"!==t}}if("_"===t)return!1;for(;i<a;i++)if("_"!==(t=e[i])){if(!zt(e.charCodeAt(i)))return!1;r=!0}return!(!r||"_"===t)},construct:function(e){var t,n=e,a=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(a=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return a*parseInt(n.slice(2),2);if("x"===n[1])return a*parseInt(n.slice(2),16);if("o"===n[1])return a*parseInt(n.slice(2),8)}return a*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!At.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Ht=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var Kt=/^[-+]?[0-9]+e/;var Gt=new Ft("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!Ht.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||At.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(At.isNegativeZero(e))return"-0.0";return n=e.toString(10),Kt.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),Qt=Ut.extend({implicit:[Wt,$t,Vt,Gt]}),Xt=Qt,Jt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),en=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var tn=new Ft("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==Jt.exec(e)||null!==en.exec(e))},construct:function(e){var t,n,a,i,r,s,o,l,u=0,c=null;if(null===(t=Jt.exec(e))&&(t=en.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],a=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,a,i));if(r=+t[4],s=+t[5],o=+t[6],t[7]){for(u=t[7].slice(0,3);u.length<3;)u+="0";u=+u}return t[9]&&(c=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(c=-c)),l=new Date(Date.UTC(n,a,i,r,s,o,u)),c&&l.setTime(l.getTime()-c),l},instanceOf:Date,represent:function(e){return e.toISOString()}});var nn=new Ft("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),an="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var rn=new Ft("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,a=0,i=e.length,r=an;for(n=0;n<i;n++)if(!((t=r.indexOf(e.charAt(n)))>64)){if(t<0)return!1;a+=6}return a%8==0},construct:function(e){var t,n,a=e.replace(/[\r\n=]/g,""),i=a.length,r=an,s=0,o=[];for(t=0;t<i;t++)t%4==0&&t&&(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)),s=s<<6|r.indexOf(a.charAt(t));return 0===(n=i%4*6)?(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)):18===n?(o.push(s>>10&255),o.push(s>>2&255)):12===n&&o.push(s>>4&255),new Uint8Array(o)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,a="",i=0,r=e.length,s=an;for(t=0;t<r;t++)t%3==0&&t&&(a+=s[i>>18&63],a+=s[i>>12&63],a+=s[i>>6&63],a+=s[63&i]),i=(i<<8)+e[t];return 0===(n=r%3)?(a+=s[i>>18&63],a+=s[i>>12&63],a+=s[i>>6&63],a+=s[63&i]):2===n?(a+=s[i>>10&63],a+=s[i>>4&63],a+=s[i<<2&63],a+=s[64]):1===n&&(a+=s[i>>2&63],a+=s[i<<4&63],a+=s[64],a+=s[64]),a}}),sn=Object.prototype.hasOwnProperty,on=Object.prototype.toString;var ln=new Ft("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,a,i,r,s=[],o=e;for(t=0,n=o.length;t<n;t+=1){if(a=o[t],r=!1,"[object Object]"!==on.call(a))return!1;for(i in a)if(sn.call(a,i)){if(r)return!1;r=!0}if(!r)return!1;if(-1!==s.indexOf(i))return!1;s.push(i)}return!0},construct:function(e){return null!==e?e:[]}}),un=Object.prototype.toString;var cn=new Ft("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,a,i,r,s=e;for(r=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(a=s[t],"[object Object]"!==un.call(a))return!1;if(1!==(i=Object.keys(a)).length)return!1;r[t]=[i[0],a[i[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,a,i,r,s=e;for(r=new Array(s.length),t=0,n=s.length;t<n;t+=1)a=s[t],i=Object.keys(a),r[t]=[i[0],a[i[0]]];return r}}),dn=Object.prototype.hasOwnProperty;var pn=new Ft("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(dn.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),hn=Xt.extend({implicit:[tn,nn],explicit:[rn,ln,cn,pn]}),fn=Object.prototype.hasOwnProperty,mn=1,gn=2,_n=3,yn=4,vn=1,bn=2,kn=3,wn=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,xn=/[\x85\u2028\u2029]/,Sn=/[,\[\]\{\}]/,Tn=/^(?:!|!!|![a-z\-]+!)$/i,An=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Cn(e){return Object.prototype.toString.call(e)}function Nn(e){return 10===e||13===e}function On(e){return 9===e||32===e}function Ln(e){return 9===e||32===e||10===e||13===e}function En(e){return 44===e||91===e||93===e||123===e||125===e}function In(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function jn(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function Mn(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var Fn=new Array(256),Zn=new Array(256),Dn=0;Dn<256;Dn++)Fn[Dn]=jn(Dn)?1:0,Zn[Dn]=jn(Dn);function Pn(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||hn,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function qn(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=It(n),new Ot(t,n)}function Bn(e,t){throw qn(e,t)}function Rn(e,t){e.onWarning&&e.onWarning.call(null,qn(e,t))}var Un={YAML:function(e,t,n){var a,i,r;null!==e.version&&Bn(e,"duplication of %YAML directive"),1!==n.length&&Bn(e,"YAML directive accepts exactly one argument"),null===(a=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&Bn(e,"ill-formed argument of the YAML directive"),i=parseInt(a[1],10),r=parseInt(a[2],10),1!==i&&Bn(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=r<2,1!==r&&2!==r&&Rn(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var a,i;2!==n.length&&Bn(e,"TAG directive accepts exactly two arguments"),a=n[0],i=n[1],Tn.test(a)||Bn(e,"ill-formed tag handle (first argument) of the TAG directive"),fn.call(e.tagMap,a)&&Bn(e,'there is a previously declared suffix for "'+a+'" tag handle'),An.test(i)||Bn(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){Bn(e,"tag prefix is malformed: "+i)}e.tagMap[a]=i}};function Wn(e,t,n,a){var i,r,s,o;if(t<n){if(o=e.input.slice(t,n),a)for(i=0,r=o.length;i<r;i+=1)9===(s=o.charCodeAt(i))||32<=s&&s<=1114111||Bn(e,"expected valid JSON character");else wn.test(o)&&Bn(e,"the stream contains non-printable characters");e.result+=o}}function $n(e,t,n,a){var i,r,s,o;for(At.isObject(n)||Bn(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,o=(i=Object.keys(n)).length;s<o;s+=1)r=i[s],fn.call(t,r)||(t[r]=n[r],a[r]=!0)}function Yn(e,t,n,a,i,r,s,o,l){var u,c;if(Array.isArray(i))for(u=0,c=(i=Array.prototype.slice.call(i)).length;u<c;u+=1)Array.isArray(i[u])&&Bn(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===Cn(i[u])&&(i[u]="[object Object]");if("object"==typeof i&&"[object Object]"===Cn(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===a)if(Array.isArray(r))for(u=0,c=r.length;u<c;u+=1)$n(e,t,r[u],n);else $n(e,t,r,n);else e.json||fn.call(n,i)||!fn.call(t,i)||(e.line=s||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Bn(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:r}):t[i]=r,delete n[i];return t}function zn(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):Bn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function Vn(e,t,n){for(var a=0,i=e.input.charCodeAt(e.position);0!==i;){for(;On(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!Nn(i))break;for(zn(e),i=e.input.charCodeAt(e.position),a++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==a&&e.lineIndent<n&&Rn(e,"deficient indentation"),a}function Hn(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!Ln(t)))}function Kn(e,t){1===t?e.result+=" ":t>1&&(e.result+=At.repeat("\n",t-1))}function Gn(e,t){var n,a,i=e.tag,r=e.anchor,s=[],o=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),a=e.input.charCodeAt(e.position);0!==a&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,Bn(e,"tab characters must not be used in indentation")),45===a)&&Ln(e.input.charCodeAt(e.position+1));)if(o=!0,e.position++,Vn(e,!0,-1)&&e.lineIndent<=t)s.push(null),a=e.input.charCodeAt(e.position);else if(n=e.line,Jn(e,t,_n,!1,!0),s.push(e.result),Vn(e,!0,-1),a=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==a)Bn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!o&&(e.tag=i,e.anchor=r,e.kind="sequence",e.result=s,!0)}function Qn(e){var t,n,a,i,r=!1,s=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&Bn(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(r=!0,i=e.input.charCodeAt(++e.position)):33===i?(s=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,r){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(a=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):Bn(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!Ln(i);)33===i&&(s?Bn(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),Tn.test(n)||Bn(e,"named tag handle cannot contain such characters"),s=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);a=e.input.slice(t,e.position),Sn.test(a)&&Bn(e,"tag suffix cannot contain flow indicator characters")}a&&!An.test(a)&&Bn(e,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch(t){Bn(e,"tag name is malformed: "+a)}return r?e.tag=a:fn.call(e.tagMap,n)?e.tag=e.tagMap[n]+a:"!"===n?e.tag="!"+a:"!!"===n?e.tag="tag:yaml.org,2002:"+a:Bn(e,'undeclared tag handle "'+n+'"'),!0}function Xn(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&Bn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!Ln(n)&&!En(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Bn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Jn(e,t,n,a,i){var r,s,o,l,u,c,d,p,h,f=1,m=!1,g=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,r=s=o=yn===n||_n===n,a&&Vn(e,!0,-1)&&(m=!0,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)),1===f)for(;Qn(e)||Xn(e);)Vn(e,!0,-1)?(m=!0,o=r,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)):o=!1;if(o&&(o=m||i),1!==f&&yn!==n||(p=mn===n||gn===n?t:t+1,h=e.position-e.lineStart,1===f?o&&(Gn(e,h)||function(e,t,n){var a,i,r,s,o,l,u,c=e.tag,d=e.anchor,p={},h=Object.create(null),f=null,m=null,g=null,_=!1,y=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=p),u=e.input.charCodeAt(e.position);0!==u;){if(_||-1===e.firstTabInLine||(e.position=e.firstTabInLine,Bn(e,"tab characters must not be used in indentation")),a=e.input.charCodeAt(e.position+1),r=e.line,63!==u&&58!==u||!Ln(a)){if(s=e.line,o=e.lineStart,l=e.position,!Jn(e,n,gn,!1,!0))break;if(e.line===r){for(u=e.input.charCodeAt(e.position);On(u);)u=e.input.charCodeAt(++e.position);if(58===u)Ln(u=e.input.charCodeAt(++e.position))||Bn(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(Yn(e,p,h,f,m,null,s,o,l),f=m=g=null),y=!0,_=!1,i=!1,f=e.tag,m=e.result;else{if(!y)return e.tag=c,e.anchor=d,!0;Bn(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=c,e.anchor=d,!0;Bn(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===u?(_&&(Yn(e,p,h,f,m,null,s,o,l),f=m=g=null),y=!0,_=!0,i=!0):_?(_=!1,i=!0):Bn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,u=a;if((e.line===r||e.lineIndent>t)&&(_&&(s=e.line,o=e.lineStart,l=e.position),Jn(e,t,yn,!0,i)&&(_?m=e.result:g=e.result),_||(Yn(e,p,h,f,m,g,s,o,l),f=m=g=null),Vn(e,!0,-1),u=e.input.charCodeAt(e.position)),(e.line===r||e.lineIndent>t)&&0!==u)Bn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&Yn(e,p,h,f,m,null,s,o,l),y&&(e.tag=c,e.anchor=d,e.kind="mapping",e.result=p),y}(e,h,p))||function(e,t){var n,a,i,r,s,o,l,u,c,d,p,h,f=!0,m=e.tag,g=e.anchor,_=Object.create(null);if(91===(h=e.input.charCodeAt(e.position)))s=93,u=!1,r=[];else{if(123!==h)return!1;s=125,u=!0,r={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=r),h=e.input.charCodeAt(++e.position);0!==h;){if(Vn(e,!0,t),(h=e.input.charCodeAt(e.position))===s)return e.position++,e.tag=m,e.anchor=g,e.kind=u?"mapping":"sequence",e.result=r,!0;f?44===h&&Bn(e,"expected the node content, but found ','"):Bn(e,"missed comma between flow collection entries"),p=null,o=l=!1,63===h&&Ln(e.input.charCodeAt(e.position+1))&&(o=l=!0,e.position++,Vn(e,!0,t)),n=e.line,a=e.lineStart,i=e.position,Jn(e,t,mn,!1,!0),d=e.tag,c=e.result,Vn(e,!0,t),h=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==h||(o=!0,h=e.input.charCodeAt(++e.position),Vn(e,!0,t),Jn(e,t,mn,!1,!0),p=e.result),u?Yn(e,r,_,d,c,p,n,a,i):o?r.push(Yn(e,null,_,d,c,p,n,a,i)):r.push(c),Vn(e,!0,t),44===(h=e.input.charCodeAt(e.position))?(f=!0,h=e.input.charCodeAt(++e.position)):f=!1}Bn(e,"unexpected end of the stream within a flow collection")}(e,p)?g=!0:(s&&function(e,t){var n,a,i,r,s,o=vn,l=!1,u=!1,c=t,d=0,p=!1;if(124===(r=e.input.charCodeAt(e.position)))a=!1;else{if(62!==r)return!1;a=!0}for(e.kind="scalar",e.result="";0!==r;)if(43===(r=e.input.charCodeAt(++e.position))||45===r)vn===o?o=43===r?kn:bn:Bn(e,"repeat of a chomping mode identifier");else{if(!((i=48<=(s=r)&&s<=57?s-48:-1)>=0))break;0===i?Bn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):u?Bn(e,"repeat of an indentation width identifier"):(c=t+i-1,u=!0)}if(On(r)){do{r=e.input.charCodeAt(++e.position)}while(On(r));if(35===r)do{r=e.input.charCodeAt(++e.position)}while(!Nn(r)&&0!==r)}for(;0!==r;){for(zn(e),e.lineIndent=0,r=e.input.charCodeAt(e.position);(!u||e.lineIndent<c)&&32===r;)e.lineIndent++,r=e.input.charCodeAt(++e.position);if(!u&&e.lineIndent>c&&(c=e.lineIndent),Nn(r))d++;else{if(e.lineIndent<c){o===kn?e.result+=At.repeat("\n",l?1+d:d):o===vn&&l&&(e.result+="\n");break}for(a?On(r)?(p=!0,e.result+=At.repeat("\n",l?1+d:d)):p?(p=!1,e.result+=At.repeat("\n",d+1)):0===d?l&&(e.result+=" "):e.result+=At.repeat("\n",d):e.result+=At.repeat("\n",l?1+d:d),l=!0,u=!0,d=0,n=e.position;!Nn(r)&&0!==r;)r=e.input.charCodeAt(++e.position);Wn(e,n,e.position,!1)}}return!0}(e,p)||function(e,t){var n,a,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,a=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(Wn(e,a,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;a=e.position,e.position++,i=e.position}else Nn(n)?(Wn(e,a,i,!0),Kn(e,Vn(e,!1,t)),a=i=e.position):e.position===e.lineStart&&Hn(e)?Bn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);Bn(e,"unexpected end of the stream within a single quoted scalar")}(e,p)||function(e,t){var n,a,i,r,s,o,l;if(34!==(o=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=a=e.position;0!==(o=e.input.charCodeAt(e.position));){if(34===o)return Wn(e,n,e.position,!0),e.position++,!0;if(92===o){if(Wn(e,n,e.position,!0),Nn(o=e.input.charCodeAt(++e.position)))Vn(e,!1,t);else if(o<256&&Fn[o])e.result+=Zn[o],e.position++;else if((s=120===(l=o)?2:117===l?4:85===l?8:0)>0){for(i=s,r=0;i>0;i--)(s=In(o=e.input.charCodeAt(++e.position)))>=0?r=(r<<4)+s:Bn(e,"expected hexadecimal character");e.result+=Mn(r),e.position++}else Bn(e,"unknown escape sequence");n=a=e.position}else Nn(o)?(Wn(e,n,a,!0),Kn(e,Vn(e,!1,t)),n=a=e.position):e.position===e.lineStart&&Hn(e)?Bn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,a=e.position)}Bn(e,"unexpected end of the stream within a double quoted scalar")}(e,p)?g=!0:!function(e){var t,n,a;if(42!==(a=e.input.charCodeAt(e.position)))return!1;for(a=e.input.charCodeAt(++e.position),t=e.position;0!==a&&!Ln(a)&&!En(a);)a=e.input.charCodeAt(++e.position);return e.position===t&&Bn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),fn.call(e.anchorMap,n)||Bn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],Vn(e,!0,-1),!0}(e)?function(e,t,n){var a,i,r,s,o,l,u,c,d=e.kind,p=e.result;if(Ln(c=e.input.charCodeAt(e.position))||En(c)||35===c||38===c||42===c||33===c||124===c||62===c||39===c||34===c||37===c||64===c||96===c)return!1;if((63===c||45===c)&&(Ln(a=e.input.charCodeAt(e.position+1))||n&&En(a)))return!1;for(e.kind="scalar",e.result="",i=r=e.position,s=!1;0!==c;){if(58===c){if(Ln(a=e.input.charCodeAt(e.position+1))||n&&En(a))break}else if(35===c){if(Ln(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&Hn(e)||n&&En(c))break;if(Nn(c)){if(o=e.line,l=e.lineStart,u=e.lineIndent,Vn(e,!1,-1),e.lineIndent>=t){s=!0,c=e.input.charCodeAt(e.position);continue}e.position=r,e.line=o,e.lineStart=l,e.lineIndent=u;break}}s&&(Wn(e,i,r,!1),Kn(e,e.line-o),i=r=e.position,s=!1),On(c)||(r=e.position+1),c=e.input.charCodeAt(++e.position)}return Wn(e,i,r,!1),!!e.result||(e.kind=d,e.result=p,!1)}(e,p,mn===n)&&(g=!0,null===e.tag&&(e.tag="?")):(g=!0,null===e.tag&&null===e.anchor||Bn(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===f&&(g=o&&Gn(e,h))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&Bn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,u=e.implicitTypes.length;l<u;l+=1)if((d=e.implicitTypes[l]).resolve(e.result)){e.result=d.construct(e.result),e.tag=d.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(fn.call(e.typeMap[e.kind||"fallback"],e.tag))d=e.typeMap[e.kind||"fallback"][e.tag];else for(d=null,l=0,u=(c=e.typeMap.multi[e.kind||"fallback"]).length;l<u;l+=1)if(e.tag.slice(0,c[l].tag.length)===c[l].tag){d=c[l];break}d||Bn(e,"unknown tag !<"+e.tag+">"),null!==e.result&&d.kind!==e.kind&&Bn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+d.kind+'", not "'+e.kind+'"'),d.resolve(e.result,e.tag)?(e.result=d.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):Bn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||g}function ea(e){var t,n,a,i,r=e.position,s=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(Vn(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(s=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!Ln(i);)i=e.input.charCodeAt(++e.position);for(a=[],(n=e.input.slice(t,e.position)).length<1&&Bn(e,"directive name must not be less than one character in length");0!==i;){for(;On(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!Nn(i));break}if(Nn(i))break;for(t=e.position;0!==i&&!Ln(i);)i=e.input.charCodeAt(++e.position);a.push(e.input.slice(t,e.position))}0!==i&&zn(e),fn.call(Un,n)?Un[n](e,n,a):Rn(e,'unknown document directive "'+n+'"')}Vn(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,Vn(e,!0,-1)):s&&Bn(e,"directives end mark is expected"),Jn(e,e.lineIndent-1,yn,!1,!0),Vn(e,!0,-1),e.checkLineBreaks&&xn.test(e.input.slice(r,e.position))&&Rn(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Hn(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,Vn(e,!0,-1)):e.position<e.length-1&&Bn(e,"end of the stream or a document separator is expected")}function ta(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new Pn(e,t),a=e.indexOf("\0");for(-1!==a&&(n.position=a,Bn(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)ea(n);return n.documents}var na=function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var a=ta(e,n);if("function"!=typeof t)return a;for(var i=0,r=a.length;i<r;i+=1)t(a[i])},aa={loadAll:na,load:function(e,t){var n=ta(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new Ot("expected a single document in the stream, but found more")}}},ia=Object.prototype.toString,ra=Object.prototype.hasOwnProperty,sa=65279,oa=9,la=10,ua=13,ca=32,da=33,pa=34,ha=35,fa=37,ma=38,ga=39,_a=42,ya=44,va=45,ba=58,ka=61,wa=62,xa=63,Sa=64,Ta=91,Aa=93,Ca=96,Na=123,Oa=124,La=125,Ea={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},Ia=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],ja=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function Ma(e){var t,n,a;if(t=e.toString(16).toUpperCase(),e<=255)n="x",a=2;else if(e<=65535)n="u",a=4;else{if(!(e<=4294967295))throw new Ot("code point within a string may not be greater than 0xFFFFFFFF");n="U",a=8}return"\\"+n+At.repeat("0",a-t.length)+t}var Fa=1,Za=2;function Da(e){this.schema=e.schema||hn,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=At.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,a,i,r,s,o,l;if(null===t)return{};for(n={},i=0,r=(a=Object.keys(t)).length;i<r;i+=1)s=a[i],o=String(t[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(l=e.compiledTypeMap.fallback[s])&&ra.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[s]=o;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?Za:Fa,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Pa(e,t){for(var n,a=At.repeat(" ",t),i=0,r=-1,s="",o=e.length;i<o;)-1===(r=e.indexOf("\n",i))?(n=e.slice(i),i=o):(n=e.slice(i,r+1),i=r+1),n.length&&"\n"!==n&&(s+=a),s+=n;return s}function qa(e,t){return"\n"+At.repeat(" ",e.indent*t)}function Ba(e){return e===ca||e===oa}function Ra(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==sa||65536<=e&&e<=1114111}function Ua(e){return Ra(e)&&e!==sa&&e!==ua&&e!==la}function Wa(e,t,n){var a=Ua(e),i=a&&!Ba(e);return(n?a:a&&e!==ya&&e!==Ta&&e!==Aa&&e!==Na&&e!==La)&&e!==ha&&!(t===ba&&!i)||Ua(t)&&!Ba(t)&&e===ha||t===ba&&i}function $a(e,t){var n,a=e.charCodeAt(t);return a>=55296&&a<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(a-55296)+n-56320+65536:a}function Ya(e){return/^\n* /.test(e)}var za=1,Va=2,Ha=3,Ka=4,Ga=5;function Qa(e,t,n,a,i,r,s,o){var l,u,c=0,d=null,p=!1,h=!1,f=-1!==a,m=-1,g=Ra(u=$a(e,0))&&u!==sa&&!Ba(u)&&u!==va&&u!==xa&&u!==ba&&u!==ya&&u!==Ta&&u!==Aa&&u!==Na&&u!==La&&u!==ha&&u!==ma&&u!==_a&&u!==da&&u!==Oa&&u!==ka&&u!==wa&&u!==ga&&u!==pa&&u!==fa&&u!==Sa&&u!==Ca&&function(e){return!Ba(e)&&e!==ba}($a(e,e.length-1));if(t||s)for(l=0;l<e.length;c>=65536?l+=2:l++){if(!Ra(c=$a(e,l)))return Ga;g=g&&Wa(c,d,o),d=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if((c=$a(e,l))===la)p=!0,f&&(h=h||l-m-1>a&&" "!==e[m+1],m=l);else if(!Ra(c))return Ga;g=g&&Wa(c,d,o),d=c}h=h||f&&l-m-1>a&&" "!==e[m+1]}return p||h?n>9&&Ya(e)?Ga:s?r===Za?Ga:Va:h?Ka:Ha:!g||s||i(e)?r===Za?Ga:Va:za}function Xa(e,t,n,a,i){e.dump=function(){if(0===t.length)return e.quotingType===Za?'""':"''";if(!e.noCompatMode&&(-1!==Ia.indexOf(t)||ja.test(t)))return e.quotingType===Za?'"'+t+'"':"'"+t+"'";var r=e.indent*Math.max(1,n),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-r),o=a||e.flowLevel>-1&&n>=e.flowLevel;switch(Qa(t,o,e.indent,s,(function(t){return function(e,t){var n,a;for(n=0,a=e.implicitTypes.length;n<a;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!a,i)){case za:return t;case Va:return"'"+t.replace(/'/g,"''")+"'";case Ha:return"|"+Ja(t,e.indent)+ei(Pa(t,r));case Ka:return">"+Ja(t,e.indent)+ei(Pa(function(e,t){var n,a,i=/(\n+)([^\n]*)/g,r=(o=e.indexOf("\n"),o=-1!==o?o:e.length,i.lastIndex=o,ti(e.slice(0,o),t)),s="\n"===e[0]||" "===e[0];var o;for(;a=i.exec(e);){var l=a[1],u=a[2];n=" "===u[0],r+=l+(s||n||""===u?"":"\n")+ti(u,t),s=n}return r}(t,s),r));case Ga:return'"'+function(e){for(var t,n="",a=0,i=0;i<e.length;a>=65536?i+=2:i++)a=$a(e,i),!(t=Ea[a])&&Ra(a)?(n+=e[i],a>=65536&&(n+=e[i+1])):n+=t||Ma(a);return n}(t)+'"';default:throw new Ot("impossible error: invalid scalar style")}}()}function Ja(e,t){var n=Ya(e)?String(t):"",a="\n"===e[e.length-1];return n+(a&&("\n"===e[e.length-2]||"\n"===e)?"+":a?"":"-")+"\n"}function ei(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function ti(e,t){if(""===e||" "===e[0])return e;for(var n,a,i=/ [^ ]/g,r=0,s=0,o=0,l="";n=i.exec(e);)(o=n.index)-r>t&&(a=s>r?s:o,l+="\n"+e.slice(r,a),r=a+1),s=o;return l+="\n",e.length-r>t&&s>r?l+=e.slice(r,s)+"\n"+e.slice(s+1):l+=e.slice(r),l.slice(1)}function ni(e,t,n,a){var i,r,s,o="",l=e.tag;for(i=0,r=n.length;i<r;i+=1)s=n[i],e.replacer&&(s=e.replacer.call(n,String(i),s)),(ii(e,t+1,s,!0,!0,!1,!0)||void 0===s&&ii(e,t+1,null,!0,!0,!1,!0))&&(a&&""===o||(o+=qa(e,t)),e.dump&&la===e.dump.charCodeAt(0)?o+="-":o+="- ",o+=e.dump);e.tag=l,e.dump=o||"[]"}function ai(e,t,n){var a,i,r,s,o,l;for(r=0,s=(i=n?e.explicitTypes:e.implicitTypes).length;r<s;r+=1)if(((o=i[r]).instanceOf||o.predicate)&&(!o.instanceOf||"object"==typeof t&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,"[object Function]"===ia.call(o.represent))a=o.represent(t,l);else{if(!ra.call(o.represent,l))throw new Ot("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');a=o.represent[l](t,l)}e.dump=a}return!0}return!1}function ii(e,t,n,a,i,r,s){e.tag=null,e.dump=n,ai(e,n,!1)||ai(e,n,!0);var o,l=ia.call(e.dump),u=a;a&&(a=e.flowLevel<0||e.flowLevel>t);var c,d,p="[object Object]"===l||"[object Array]"===l;if(p&&(d=-1!==(c=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||d||2!==e.indent&&t>0)&&(i=!1),d&&e.usedDuplicates[c])e.dump="*ref_"+c;else{if(p&&d&&!e.usedDuplicates[c]&&(e.usedDuplicates[c]=!0),"[object Object]"===l)a&&0!==Object.keys(e.dump).length?(!function(e,t,n,a){var i,r,s,o,l,u,c="",d=e.tag,p=Object.keys(n);if(!0===e.sortKeys)p.sort();else if("function"==typeof e.sortKeys)p.sort(e.sortKeys);else if(e.sortKeys)throw new Ot("sortKeys must be a boolean or a function");for(i=0,r=p.length;i<r;i+=1)u="",a&&""===c||(u+=qa(e,t)),o=n[s=p[i]],e.replacer&&(o=e.replacer.call(n,s,o)),ii(e,t+1,s,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&la===e.dump.charCodeAt(0)?u+="?":u+="? "),u+=e.dump,l&&(u+=qa(e,t)),ii(e,t+1,o,!0,l)&&(e.dump&&la===e.dump.charCodeAt(0)?u+=":":u+=": ",c+=u+=e.dump));e.tag=d,e.dump=c||"{}"}(e,t,e.dump,i),d&&(e.dump="&ref_"+c+e.dump)):(!function(e,t,n){var a,i,r,s,o,l="",u=e.tag,c=Object.keys(n);for(a=0,i=c.length;a<i;a+=1)o="",""!==l&&(o+=", "),e.condenseFlow&&(o+='"'),s=n[r=c[a]],e.replacer&&(s=e.replacer.call(n,r,s)),ii(e,t,r,!1,!1)&&(e.dump.length>1024&&(o+="? "),o+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),ii(e,t,s,!1,!1)&&(l+=o+=e.dump));e.tag=u,e.dump="{"+l+"}"}(e,t,e.dump),d&&(e.dump="&ref_"+c+" "+e.dump));else if("[object Array]"===l)a&&0!==e.dump.length?(e.noArrayIndent&&!s&&t>0?ni(e,t-1,e.dump,i):ni(e,t,e.dump,i),d&&(e.dump="&ref_"+c+e.dump)):(!function(e,t,n){var a,i,r,s="",o=e.tag;for(a=0,i=n.length;a<i;a+=1)r=n[a],e.replacer&&(r=e.replacer.call(n,String(a),r)),(ii(e,t,r,!1,!1)||void 0===r&&ii(e,t,null,!1,!1))&&(""!==s&&(s+=","+(e.condenseFlow?"":" ")),s+=e.dump);e.tag=o,e.dump="["+s+"]"}(e,t,e.dump),d&&(e.dump="&ref_"+c+" "+e.dump));else{if("[object String]"!==l){if("[object Undefined]"===l)return!1;if(e.skipInvalid)return!1;throw new Ot("unacceptable kind of an object to dump "+l)}"?"!==e.tag&&Xa(e,e.dump,t,r,u)}null!==e.tag&&"?"!==e.tag&&(o=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),o="!"===e.tag[0]?"!"+o:"tag:yaml.org,2002:"===o.slice(0,18)?"!!"+o.slice(18):"!<"+o+">",e.dump=o+" "+e.dump)}return!0}function ri(e,t){var n,a,i=[],r=[];for(si(e,i,r),n=0,a=r.length;n<a;n+=1)t.duplicates.push(i[r[n]]);t.usedDuplicates=new Array(a)}function si(e,t,n){var a,i,r;if(null!==e&&"object"==typeof e)if(-1!==(i=t.indexOf(e)))-1===n.indexOf(i)&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,r=e.length;i<r;i+=1)si(e[i],t,n);else for(i=0,r=(a=Object.keys(e)).length;i<r;i+=1)si(e[a[i]],t,n)}function oi(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var li={Type:Ft,Schema:Pt,FAILSAFE_SCHEMA:Ut,JSON_SCHEMA:Qt,CORE_SCHEMA:Xt,DEFAULT_SCHEMA:hn,load:aa.load,loadAll:aa.loadAll,dump:{dump:function(e,t){var n=new Da(t=t||{});n.noRefs||ri(e,n);var a=e;return n.replacer&&(a=n.replacer.call({"":a},"",a)),ii(n,0,a,!0,!0)?n.dump+"\n":""}}.dump,YAMLException:Ot,types:{binary:rn,float:Gt,map:Rt,null:Wt,pairs:cn,set:pn,timestamp:tn,bool:$t,int:Vt,merge:nn,omap:ln,seq:Bt,str:qt},safeLoad:oi("safeLoad","load"),safeLoadAll:oi("safeLoadAll","loadAll"),safeDump:oi("safeDump","dump")};class ui{constructor(e,t,n,a,i,r){this.database=a,this.backupController=e,this.backupSettings=t,this.services=n,this.schema=i,this.backupLogger=r}async init(){}async getDirectusDatabasePath(){let e=await this.backupController.getDirectusRootFolderPath(),n=await this.backupSettings.getSQLITE3DBFilename();return t.join(e,n)}async createBackup(n){await this.backupLogger.log("Start backup");let a=await this.getDirectusDatabasePath(),i=t.join(n,"backup.db");await this.backupLogger.log("copy from: "+a),await this.backupLogger.log("copy to: "+i);try{e.copyFileSync(a,i)}catch(e){return console.log(e),null}return await this.backupLogger.log("Finished backup"),i}}function ci(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):"number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?new Date(e):new Date(NaN)}function di(e){if(!(t=e,t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)||"number"==typeof e))return!1;var t;const n=ci(e);return!isNaN(Number(n))}const pi={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function hi(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const fi={date:hi({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:hi({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:hi({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},mi={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function gi(e){return(t,n)=>{let a;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,i=n?.width?String(n.width):t;a=e.formattingValues[i]||e.formattingValues[t]}else{const t=e.defaultWidth,i=n?.width?String(n.width):e.defaultWidth;a=e.values[i]||e.values[t]}return a[e.argumentCallback?e.argumentCallback(t):t]}}const _i={ordinalNumber:(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:gi({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:gi({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:gi({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:gi({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:gi({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function yi(e){return(t,n={})=>{const a=n.width,i=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],r=t.match(i);if(!r)return null;const s=r[0],o=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,(e=>e.test(s))):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,(e=>e.test(s)));let u;u=e.valueCallback?e.valueCallback(l):l,u=n.valueCallback?n.valueCallback(u):u;return{value:u,rest:t.slice(s.length)}}}const vi={ordinalNumber:(bi={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(bi.matchPattern);if(!n)return null;const a=n[0],i=e.match(bi.parsePattern);if(!i)return null;let r=bi.valueCallback?bi.valueCallback(i[0]):i[0];return r=t.valueCallback?t.valueCallback(r):r,{value:r,rest:e.slice(a.length)}}),era:yi({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:yi({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:yi({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:yi({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:yi({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var bi;const ki={code:"en-US",formatDistance:(e,t,n)=>{let a;const i=pi[e];return a="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a},formatLong:fi,formatRelative:(e,t,n,a)=>mi[e],localize:_i,match:vi,options:{weekStartsOn:0,firstWeekContainsDate:1}};let wi={};function xi(){return wi}const Si=6048e5,Ti=864e5;function Ai(e){const t=ci(e);return t.setHours(0,0,0,0),t}function Ci(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function Ni(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Oi(e){const t=ci(e),n=function(e,t){const n=Ai(e),a=Ai(t),i=n.getTime()-Ci(n),r=a.getTime()-Ci(a);return Math.round((i-r)/Ti)}(t,function(e){const t=ci(e),n=Ni(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}(t));return n+1}function Li(e,t){const n=xi(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,i=ci(e),r=i.getDay(),s=(r<a?7:0)+r-a;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function Ei(e){return Li(e,{weekStartsOn:1})}function Ii(e){const t=ci(e),n=t.getFullYear(),a=Ni(e,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=Ei(a),r=Ni(e,0);r.setFullYear(n,0,4),r.setHours(0,0,0,0);const s=Ei(r);return t.getTime()>=i.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}function ji(e){const t=ci(e),n=Ei(t).getTime()-function(e){const t=Ii(e),n=Ni(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Ei(n)}(t).getTime();return Math.round(n/Si)+1}function Mi(e,t){const n=ci(e),a=n.getFullYear(),i=xi(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=Ni(e,0);s.setFullYear(a+1,0,r),s.setHours(0,0,0,0);const o=Li(s,t),l=Ni(e,0);l.setFullYear(a,0,r),l.setHours(0,0,0,0);const u=Li(l,t);return n.getTime()>=o.getTime()?a+1:n.getTime()>=u.getTime()?a:a-1}function Fi(e,t){const n=ci(e),a=Li(n,t).getTime()-function(e,t){const n=xi(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,i=Mi(e,t),r=Ni(e,0);return r.setFullYear(i,0,a),r.setHours(0,0,0,0),Li(r,t)}(n,t).getTime();return Math.round(a/Si)+1}function Zi(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Di={y(e,t){const n=e.getFullYear(),a=n>0?n:1-n;return Zi("yy"===t?a%100:a,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):Zi(n+1,2)},d:(e,t)=>Zi(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>Zi(e.getHours()%12||12,t.length),H:(e,t)=>Zi(e.getHours(),t.length),m:(e,t)=>Zi(e.getMinutes(),t.length),s:(e,t)=>Zi(e.getSeconds(),t.length),S(e,t){const n=t.length,a=e.getMilliseconds();return Zi(Math.floor(a*Math.pow(10,n-3)),t.length)}},Pi="midnight",qi="noon",Bi="morning",Ri="afternoon",Ui="evening",Wi="night",$i={G:function(e,t,n){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});default:return n.era(a,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),a=t>0?t:1-t;return n.ordinalNumber(a,{unit:"year"})}return Di.y(e,t)},Y:function(e,t,n,a){const i=Mi(e,a),r=i>0?i:1-i;if("YY"===t){return Zi(r%100,2)}return"Yo"===t?n.ordinalNumber(r,{unit:"year"}):Zi(r,t.length)},R:function(e,t){return Zi(Ii(e),t.length)},u:function(e,t){return Zi(e.getFullYear(),t.length)},Q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return Zi(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return Zi(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,n){const a=e.getMonth();switch(t){case"M":case"MM":return Di.M(e,t);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,n){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return Zi(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,n,a){const i=Fi(e,a);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):Zi(i,t.length)},I:function(e,t,n){const a=ji(e);return"Io"===t?n.ordinalNumber(a,{unit:"week"}):Zi(a,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):Di.d(e,t)},D:function(e,t,n){const a=Oi(e);return"Do"===t?n.ordinalNumber(a,{unit:"dayOfYear"}):Zi(a,t.length)},E:function(e,t,n){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,n,a){const i=e.getDay(),r=(i-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(r);case"ee":return Zi(r,2);case"eo":return n.ordinalNumber(r,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,a){const i=e.getDay(),r=(i-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(r);case"cc":return Zi(r,t.length);case"co":return n.ordinalNumber(r,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){const a=e.getDay(),i=0===a?7:a;switch(t){case"i":return String(i);case"ii":return Zi(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const a=e.getHours();let i;switch(i=12===a?qi:0===a?Pi:a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,n){const a=e.getHours();let i;switch(i=a>=17?Ui:a>=12?Ri:a>=4?Bi:Wi,t){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return Di.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):Di.H(e,t)},K:function(e,t,n){const a=e.getHours()%12;return"Ko"===t?n.ordinalNumber(a,{unit:"hour"}):Zi(a,t.length)},k:function(e,t,n){let a=e.getHours();return 0===a&&(a=24),"ko"===t?n.ordinalNumber(a,{unit:"hour"}):Zi(a,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Di.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Di.s(e,t)},S:function(e,t){return Di.S(e,t)},X:function(e,t,n,a){const i=(a._originalDate||e).getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return zi(i);case"XXXX":case"XX":return Vi(i);default:return Vi(i,":")}},x:function(e,t,n,a){const i=(a._originalDate||e).getTimezoneOffset();switch(t){case"x":return zi(i);case"xxxx":case"xx":return Vi(i);default:return Vi(i,":")}},O:function(e,t,n,a){const i=(a._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Yi(i,":");default:return"GMT"+Vi(i,":")}},z:function(e,t,n,a){const i=(a._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Yi(i,":");default:return"GMT"+Vi(i,":")}},t:function(e,t,n,a){const i=a._originalDate||e;return Zi(Math.floor(i.getTime()/1e3),t.length)},T:function(e,t,n,a){return Zi((a._originalDate||e).getTime(),t.length)}};function Yi(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),i=Math.floor(a/60),r=a%60;return 0===r?n+String(i):n+String(i)+t+Zi(r,2)}function zi(e,t){if(e%60==0){return(e>0?"-":"+")+Zi(Math.abs(e)/60,2)}return Vi(e,t)}function Vi(e,t=""){const n=e>0?"-":"+",a=Math.abs(e);return n+Zi(Math.floor(a/60),2)+t+Zi(a%60,2)}const Hi=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Ki=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Gi={p:Ki,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],a=n[1],i=n[2];if(!i)return Hi(e,t);let r;switch(a){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",Hi(a,t)).replace("{{time}}",Ki(i,t))}},Qi=/^D+$/,Xi=/^Y+$/,Ji=["D","DD","YY","YYYY"];function er(e,t,n){const a=function(e,t,n){const a="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(a),Ji.includes(e))throw new RangeError(a)}const tr=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,nr=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ar=/^'([^]*?)'?$/,ir=/''/g,rr=/[a-zA-Z]/;function sr(e,t,n){const a=xi(),i=n?.locale??a.locale??ki,r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,o=ci(e);if(!di(o))throw new RangeError("Invalid time value");const l={firstWeekContainsDate:r,weekStartsOn:s,locale:i,_originalDate:o};return t.match(nr).map((function(e){const t=e[0];if("p"===t||"P"===t){return(0,Gi[t])(e,i.formatLong)}return e})).join("").match(tr).map((function(a){if("''"===a)return"'";const r=a[0];if("'"===r)return function(e){const t=e.match(ar);if(!t)return e;return t[1].replace(ir,"'")}(a);const s=$i[r];if(s)return!n?.useAdditionalWeekYearTokens&&(u=a,Xi.test(u))&&er(a,t,String(e)),!n?.useAdditionalDayOfYearTokens&&function(e){return Qi.test(e)}(a)&&er(a,t,String(e)),s(o,a,i.localize,l);var u;if(r.match(rr))throw new RangeError("Format string contains an unescaped latin alphabet character `"+r+"`");return a})).join("")}class or{constructor(e){this.backupSettings=e,this.currentLog=""}async resetLog(){this.currentLog="",await this.backupSettings.setLatestLog("")}async log(e){let t=new Date;this.currentLog=this.currentLog+"\n "+t.toISOString()+": "+e,await this.backupSettings.setLatestLog(this.currentLog)}}const lr=process.env;class ur{constructor(e,t,n){this.database=t,this.services=e,this.schema=n,this.backupSettings=new xt(e,t,n),this.finished=!0,this.filesService=this.getFileService(n,e),this.foldersService=this.getFolderService(n,e),this.logger=new or(this.backupSettings)}getFileService(e,t){return new t.FilesService({schema:e,accountability:null})}getFolderService(e,t){return new t.FoldersService({schema:e,accountability:null})}async init(){await this.backupSettings.init()}async getNewBackupFilenameWithoutExtension(e){let t=await this.backupSettings.getBackupFileFormatPrefix(),n=await this.backupSettings.getBackupFileFormatPostfix(),a=await this.backupSettings.getBackupFileFormat(),i=e||new Date,r=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()+"-"+i.getHours()+"-"+i.getMinutes()+"-"+i.getSeconds()+"-"+i.getMilliseconds();try{r=sr(i,a)}catch(e){await this.logger.log("Error: Could not format date but using default: "+e)}return t+r+n}async getDirectusRootFolderPath(){let e=t.join("/");return t.resolve(e)}async createFolderIfNotExists(t){e.existsSync(t)||e.mkdirSync(t,{recursive:!0})}async getTempFolderPath(){let e=await this.getDirectusRootFolderPath();return t.join(e,"directus","database","temp")}async deleteTempFolder(){let t=await this.getTempFolderPath();await this.logger.log("Delete temp folder: "+t),e.existsSync(t)&&e.rmSync(t,{recursive:!0}),await this.logger.log("Temp folder deleted")}getFileExtension(e){return t.extname(e)}async createOrGetFileLibraryFolder(e,t){if(t){await this.logger.log("Folder id set: "+t+" - check if folder exists");const n=await this.foldersService.readOne(t);return n?(await this.logger.log("Folder instance found: "+t+" - update folder name"),await this.backupSettings.setBackupLocationFileLibraryFolderName(n.name),t):(await this.logger.log("Folder instance not found: "+t+" - create folder"),await this.createOrGetFileLibraryFolder(e,null))}{await this.logger.log("Backup location folder id not set");const n=await this.foldersService.createOne({name:e});return await this.logger.log("Backup location folder created: "+n),(t=n)?(await this.logger.log("Backup location folder id set: "+t),await this.backupSettings.setBackupLocationFileLibraryFolderID(t),t):(console.log("Error: Could not create folder"),await this.logger.log("Error: Could not create folder"),null)}}getFileLibraryStorageLocation(){return(lr.STORAGE_LOCATIONS||"").split(",")[0]}async moveBackupFileToFilelibrary(t,n){await this.logger.log("Move backup file to file library");let a=await this.backupSettings.getBackupLocationFileLibraryFolderName(),i=await this.backupSettings.getBackupLocationFileLibraryFolderID(),r=await this.createOrGetFileLibraryFolder(a,i);if(!r)return await this.logger.log("Error: Could not create or get file library folder"),null;{let a={title:n,tags:["backup"],filename_download:n,filesize:e.statSync(t).size,folder:r,type:"application/octet-stream",storage:this.getFileLibraryStorageLocation()},i=e.createReadStream(t);await this.logger.log("Upload backup file to file library"),await this.filesService.uploadOne(i,a),await this.logger.log("Backup file moved to file library")}}async moveBackupFileToCustomPath(n,a){await this.logger.log("Move backup file to custom path");let i=await this.backupSettings.getBackupLocationCustomPath();await this.logger.log("Create if not exists: "+i),await this.createFolderIfNotExists(i);let r=await this.getDirectusRootFolderPath(),s=t.join(r,i,a);try{return await this.logger.log("Move backup file to custom path: "+s),e.copyFileSync(n,s),await this.deleteTempFolder(),!0}catch(e){return console.log(e),await this.logger.log(e.toString()),await this.deleteTempFolder(),!1}}async moveBackupFileToFinalBackupFolder(e,t){await this.logger.log("Move backup file to backup folder");let n=this.getFileExtension(e),a=await this.getNewBackupFilenameWithoutExtension(t)+n;console.log("Backup filename: "+a),await this.logger.log("Backup filename: "+a);let i=await this.backupSettings.getBackupLocationType();console.log("Backup location type: "+i),await this.logger.log("Backup location type: "+i),this.backupSettings.isBackupLocationTypeFileLibrary(i)?await this.moveBackupFileToFilelibrary(e,a):this.backupSettings.isBackupLocationTypeCustomPath(i)&&await this.moveBackupFileToCustomPath(e,a)}async createBackup(){await this.logger.resetLog(),await this.logger.log("Init start backup");let e=await this.getTempFolderPath();await this.createFolderIfNotExists(e);let t=null,n=await this.backupSettings.getDBClient();if(this.backupSettings.isSQLITE3DBClient(n)&&(await this.logger.log("SQLITE3 DB Client selected"),t=new ui(this,this.backupSettings,this.services,this.database,this.schema,await this.logger),await t.init()),t){let n=new Date,a=await t.createBackup(e);a?(await this.logger.log("Backup created and temporarily stored at: "+a),await this.moveBackupFileToFinalBackupFolder(a,n),console.log("Moved backup file to backup folder finished"),await this.logger.log("Moved backup file to backup folder finished")):(console.log("Backup failed, since no backup file was created"),await this.logger.log("Backup failed, since no backup file was created"))}else console.log("No specific controller found for db client: "+n),await this.logger.log("No specific controller found for db client: "+n)}async checkIfBackup(){if(await this.backupSettings.getActiveStatus()){let e=await this.backupSettings.getState(),t="finished",n="running",a="failed";if(e==="create"&&this.finished){this.finished=!1,await this.backupSettings.setCurrentState(n);try{await this.createBackup(),this.finished=!0,await this.backupSettings.setCurrentState(t)}catch(e){await this.backupSettings.setLatestLog(e.toString()),this.finished=!0,await this.backupSettings.setCurrentState(a)}}else e===n||this.finished||await this.backupSettings.setCurrentState(n)}}}var cr=({filter:e,action:t,init:n,schedule:a},{services:i,database:r,getSchema:s,logger:o})=>{console.log("Init auto backup"),t("server.start",(async(e,t)=>{let n=await s();await async function(e,t,n){const a=li.load("version: 1\ndirectus: 9.18.1\ncollections:\n  - collection: auto_backup_settings\n    meta:\n      accountability: all\n      archive_app_filter: true\n      archive_field: null\n      archive_value: archived\n      collapse: open\n      collection: auto_backup_settings\n      color: null\n      display_template: null\n      group: null\n      hidden: false\n      icon: null\n      item_duplication_fields: null\n      note: null\n      singleton: true\n      sort: null\n      sort_field: null\n      translations: null\n      unarchive_value: draft\n    schema:\n      name: auto_backup_settings\n      sql: >-\n        CREATE TABLE \"auto_backup_settings\" (`DB_CLIENT` varchar(255) NULL\n        DEFAULT null, `active` boolean NULL DEFAULT '0', `backup_file_format`\n        varchar(255) NULL DEFAULT 'yyyy-MM-dd-HH-mm-SS-SSS',\n        `backup_location_custom_path` char(36) NULL DEFAULT\n        '/directus/database/backups', `backup_location_folder_id` char(36) NULL\n        DEFAULT null, `backup_location_folder_name` char(36) NULL DEFAULT\n        'backups', `backup_location_type` varchar(255) NULL DEFAULT\n        'file_library', `date_created` datetime NULL DEFAULT null,\n        `date_updated` datetime NULL DEFAULT null, `id` integer PRIMARY KEY\n        AUTOINCREMENT NOT NULL, `latest_log` text NULL DEFAULT null,\n        `sqlite3_db_filename` varchar(255) NULL DEFAULT\n        '/directus/database/data.db', `state` varchar(255) NULL DEFAULT\n        'finished', `user_created` varchar(36) NULL DEFAULT null, `user_updated`\n        varchar(36) NULL DEFAULT null, `backup_file_format_prefix` varchar(255)\n        NULL DEFAULT 'backup-', `backup_file_format_postfix` varchar(255) NULL\n        DEFAULT null)\nfields:\n  - collection: auto_backup_settings\n    field: DB_CLIENT\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: DB_CLIENT\n      group: general_settings\n      hidden: false\n      interface: select-dropdown\n      note: null\n      options:\n        allowNone: true\n        choices:\n          - text: sqlite3\n            value: sqlite3\n      readonly: false\n      required: false\n      sort: 9\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: varchar\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 255\n      name: DB_CLIENT\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: active\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: active\n      group: null\n      hidden: false\n      interface: boolean\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 8\n      special:\n        - cast-boolean\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: boolean\n      default_value: false\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: null\n      name: active\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: boolean\n  - collection: auto_backup_settings\n    field: backup_file_format\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: backup_file_format\n      group: driver_specific_settings\n      hidden: false\n      interface: input\n      note: >-\n        The default timestamp format will be: YYYY-MM-DD-HH-mm-ss-SSS. Customize\n        by using date-fns https://date-fns.org/v2.29.3/docs/format\n      options:\n        clear: true\n      readonly: false\n      required: false\n      sort: 6\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: varchar\n      default_value: yyyy-MM-dd-HH-mm-SS-SSS\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 255\n      name: backup_file_format\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: backup_file_format_postfix\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: backup_file_format_postfix\n      group: driver_specific_settings\n      hidden: false\n      interface: input\n      note: A postfix for the filename of the backup.\n      options:\n        clear: true\n      readonly: false\n      required: false\n      sort: 5\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: varchar\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 255\n      name: backup_file_format_postfix\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: backup_file_format_prefix\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: backup_file_format_prefix\n      group: driver_specific_settings\n      hidden: false\n      interface: input\n      note: A prefix for the filename of the backup.\n      options:\n        clear: true\n      readonly: false\n      required: false\n      sort: 4\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: varchar\n      default_value: backup-\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 255\n      name: backup_file_format_prefix\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: backup_location_custom_path\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: backup_location_custom_path\n      group: backup_location_type_custom\n      hidden: false\n      interface: input\n      note: 'Absolute filepath (default: /directus/database/backups)'\n      options: null\n      readonly: false\n      required: false\n      sort: 1\n      special:\n        - file\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: char\n      default_value: /directus/database/backups\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 36\n      name: backup_location_custom_path\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: uuid\n  - collection: auto_backup_settings\n    field: backup_location_folder_id\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: backup_location_folder_id\n      group: backup_location_type_file_library\n      hidden: false\n      interface: input\n      note: 'Optional: ID of the folder (otherwise we will create it)'\n      options: null\n      readonly: false\n      required: false\n      sort: 1\n      special:\n        - file\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: char\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 36\n      name: backup_location_folder_id\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: uuid\n  - collection: auto_backup_settings\n    field: backup_location_folder_name\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: backup_location_folder_name\n      group: backup_location_type_file_library\n      hidden: false\n      interface: input\n      note: 'ReadOnly: Backup folder name'\n      options: null\n      readonly: true\n      required: false\n      sort: 2\n      special:\n        - file\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: char\n      default_value: backups\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 36\n      name: backup_location_folder_name\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: uuid\n  - collection: auto_backup_settings\n    field: backup_location_type\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: backup_location_type\n      group: general_settings\n      hidden: false\n      interface: select-dropdown\n      note: Select how/where backups should be saved\n      options:\n        allowNone: true\n        choices:\n          - text: File Library\n            value: file_library\n          - text: Custom Path\n            value: custom_path\n      readonly: false\n      required: false\n      sort: 4\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: varchar\n      default_value: file_library\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 255\n      name: backup_location_type\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: backup_location_type_custom\n    meta:\n      collection: auto_backup_settings\n      conditions:\n        - name: Visible\n          rule:\n            _and:\n              - backup_location_type:\n                  _neq: custom_path\n          options: {}\n          hidden: true\n      display: null\n      display_options: null\n      field: backup_location_type_custom\n      group: general_settings\n      hidden: false\n      interface: group-raw\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 5\n      special:\n        - alias\n        - group\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: backup_location_type_file_library\n    meta:\n      collection: auto_backup_settings\n      conditions:\n        - name: Vsisible\n          rule:\n            _and:\n              - backup_location_type:\n                  _neq: file_library\n          options: {}\n          hidden: true\n      display: null\n      display_options: null\n      field: backup_location_type_file_library\n      group: general_settings\n      hidden: false\n      interface: group-raw\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 6\n      special:\n        - alias\n        - group\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: date_created\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: datetime\n      display_options:\n        relative: true\n      field: date_created\n      group: null\n      hidden: true\n      interface: datetime\n      note: null\n      options: null\n      readonly: true\n      required: false\n      sort: 3\n      special:\n        - cast-timestamp\n        - date-created\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: datetime\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: null\n      name: date_created\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: timestamp\n  - collection: auto_backup_settings\n    field: date_updated\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: datetime\n      display_options:\n        relative: true\n      field: date_updated\n      group: null\n      hidden: true\n      interface: datetime\n      note: null\n      options: null\n      readonly: true\n      required: false\n      sort: 5\n      special:\n        - cast-timestamp\n        - date-updated\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: datetime\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: null\n      name: date_updated\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: timestamp\n  - collection: auto_backup_settings\n    field: divide_to_database_type\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: divide_to_database_type\n      group: general_settings\n      hidden: false\n      interface: presentation-divider\n      note: null\n      options:\n        inlineTitle: true\n        title: Database driver\n      readonly: false\n      required: false\n      sort: 7\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: divider-oql-hz\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: divider-oql-hz\n      group: null\n      hidden: false\n      interface: presentation-divider\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 7\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: divider-qtbpzx\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: divider-qtbpzx\n      group: general_settings\n      hidden: false\n      interface: presentation-divider\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 11\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: divider_to_backup_location\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: divider_to_backup_location\n      group: general_settings\n      hidden: false\n      interface: presentation-divider\n      note: null\n      options:\n        inlineTitle: true\n        title: Backup location\n      readonly: false\n      required: false\n      sort: 2\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: driver_specific_settings\n    meta:\n      collection: auto_backup_settings\n      conditions:\n        - name: Visible\n          rule:\n            _and:\n              - DB_CLIENT:\n                  _null: true\n          hidden: true\n          options: {}\n      display: null\n      display_options: null\n      field: driver_specific_settings\n      group: general_settings\n      hidden: false\n      interface: group-raw\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 10\n      special:\n        - alias\n        - group\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: general_settings\n    meta:\n      collection: auto_backup_settings\n      conditions:\n        - name: Open\n          rule:\n            _and:\n              - active:\n                  _neq: true\n          options:\n            start: open\n      display: null\n      display_options: null\n      field: general_settings\n      group: null\n      hidden: false\n      interface: group-detail\n      note: null\n      options:\n        start: closed\n      readonly: false\n      required: false\n      sort: 6\n      special:\n        - alias\n        - group\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: id\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: id\n      group: null\n      hidden: true\n      interface: input\n      note: null\n      options: null\n      readonly: true\n      required: false\n      sort: 1\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: integer\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: true\n      is_generated: false\n      is_nullable: false\n      is_primary_key: true\n      is_unique: false\n      max_length: null\n      name: id\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: integer\n  - collection: auto_backup_settings\n    field: latest_log\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: latest_log\n      group: visibility_active\n      hidden: false\n      interface: input-multiline\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 1\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: text\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: null\n      name: latest_log\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: text\n  - collection: auto_backup_settings\n    field: notice_finished\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: notice_finished\n      group: general_settings\n      hidden: false\n      interface: presentation-notice\n      note: null\n      options:\n        text: After this setup, you only need to active the next field ACTIVE\n      readonly: false\n      required: false\n      sort: 12\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: notice_please_configure_db_client\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: notice_please_configure_db_client\n      group: general_settings\n      hidden: false\n      interface: presentation-notice\n      note: null\n      options:\n        text: Please tell us which database client you are using.\n      readonly: false\n      required: false\n      sort: 8\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: notice_please_configure_save_location\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: notice_please_configure_save_location\n      group: general_settings\n      hidden: false\n      interface: presentation-notice\n      note: null\n      options:\n        text: >-\n          Please configure where your backup should be saved. You can either\n          save it in the directus FileLibrary or define a custom path.\n      readonly: false\n      required: false\n      sort: 3\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: notice_please_setup_name_for_backupfile\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: notice_please_setup_name_for_backupfile\n      group: driver_specific_settings\n      hidden: false\n      interface: presentation-notice\n      note: null\n      options:\n        text: >-\n          You can define the name of the backup file here. The name consist of\n          the prefix, timestamp and postfix.\n      readonly: false\n      required: false\n      sort: 1\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: notice_welcome\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: notice_welcome\n      group: general_settings\n      hidden: false\n      interface: presentation-notice\n      note: null\n      options:\n        text: >-\n          Welcome to the auto backup extension. Please configure this setup.\n          After that set the field ACTIVE to true\n      readonly: false\n      required: false\n      sort: 1\n      special:\n        - alias\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: sqlite3_db_filename\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: sqlite3_db_filename\n      group: sqlite3_settings\n      hidden: false\n      interface: input\n      note: >-\n        Default from:\n        https://docs.directus.io/self-hosted/installation/docker.html\n      options: null\n      readonly: false\n      required: false\n      sort: 1\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: varchar\n      default_value: /directus/database/data.db\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 255\n      name: sqlite3_db_filename\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: sqlite3_settings\n    meta:\n      collection: auto_backup_settings\n      conditions:\n        - rule:\n            _and:\n              - DB_CLIENT:\n                  _neq: sqlite3\n          readonly: false\n          hidden: true\n          required: false\n          options: {}\n          name: Visibility\n      display: null\n      display_options: null\n      field: sqlite3_settings\n      group: driver_specific_settings\n      hidden: false\n      interface: group-raw\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 7\n      special:\n        - alias\n        - group\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\n  - collection: auto_backup_settings\n    field: state\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: null\n      display_options: null\n      field: state\n      group: null\n      hidden: false\n      interface: select-dropdown\n      note: >-\n        If you want to run auto backups, just create a directus flow and change\n        the field 'state' to the value 'check'\n      options:\n        choices:\n          - text: create <-- manual start\n            value: create\n          - text: running\n            value: running\n          - text: finished\n            value: finished\n          - text: failed\n            value: failed\n      readonly: false\n      required: false\n      sort: 9\n      special: null\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema:\n      data_type: varchar\n      default_value: finished\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 255\n      name: state\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: user_created\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: user\n      display_options: null\n      field: user_created\n      group: null\n      hidden: true\n      interface: select-dropdown-m2o\n      note: null\n      options:\n        template: '{{avatar.$thumbnail}} {{first_name}} {{last_name}}'\n      readonly: true\n      required: false\n      sort: 2\n      special:\n        - user-created\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: varchar\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 36\n      name: user_created\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: user_updated\n    meta:\n      collection: auto_backup_settings\n      conditions: null\n      display: user\n      display_options: null\n      field: user_updated\n      group: null\n      hidden: true\n      interface: select-dropdown-m2o\n      note: null\n      options:\n        template: '{{avatar.$thumbnail}} {{first_name}} {{last_name}}'\n      readonly: true\n      required: false\n      sort: 4\n      special:\n        - user-updated\n      translations: null\n      validation: null\n      validation_message: null\n      width: half\n    schema:\n      data_type: varchar\n      default_value: null\n      foreign_key_column: null\n      foreign_key_table: null\n      generation_expression: null\n      has_auto_increment: false\n      is_generated: false\n      is_nullable: true\n      is_primary_key: false\n      is_unique: false\n      max_length: 36\n      name: user_updated\n      numeric_precision: null\n      numeric_scale: null\n      table: auto_backup_settings\n    type: string\n  - collection: auto_backup_settings\n    field: visibility_active\n    meta:\n      collection: auto_backup_settings\n      conditions:\n        - name: Visibility\n          rule:\n            _and:\n              - active:\n                  _eq: true\n          options: {}\n      display: null\n      display_options: null\n      field: visibility_active\n      group: null\n      hidden: false\n      interface: group-raw\n      note: null\n      options: null\n      readonly: false\n      required: false\n      sort: 10\n      special:\n        - alias\n        - group\n        - no-data\n      translations: null\n      validation: null\n      validation_message: null\n      width: full\n    schema: null\n    type: alias\nrelations: []\n");let i=new kt(e,t,n),r=await i.getCollectionsService();try{let e=await r.readByQuery(),t=!1;for(let n of e)if(n.collection===xt.TABLENAME){t=!0;break}if(!t){console.log("Collection "+xt.TABLENAME+" not found");let e=a.collections[0],t=a.fields;console.log("Creating "+xt.TABLENAME+" collection"),await r.createOne({...e,fields:t}),console.log("Created "+xt.TABLENAME+" collection")}}catch(e){console.log(e)}}(i,r,n)})),t(xt.TABLENAME+".items.update",(async(e,t)=>{let n=await s(),a=new ur(i,r,n);await a.init();try{await a.checkIfBackup()}catch(e){console.log(e)}}))};export{cr as default};
